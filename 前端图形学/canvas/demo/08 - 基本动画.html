<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>基本动画</title>
  </head>
  <body>
    <div><canvas id="c1" height="300px"></canvas></div>
    <div><canvas id="c2" height="300px"></canvas></div>

    <script>
      // 绘制一个太阳系动画
      function drawExampleOne() {
        const sun = new Image();
        const moon = new Image();
        const earth = new Image();

        init();

        function init() {
          sun.src = "https://mdn.mozillademos.org/files/1456/Canvas_sun.png";
          moon.src = "https://mdn.mozillademos.org/files/1443/Canvas_moon.png";
          earth.src =
            "https://mdn.mozillademos.org/files/1429/Canvas_earth.png";
          window.requestAnimationFrame(draw);
        }

        function draw() {
          const ctx = document.getElementById("c1").getContext("2d");

          ctx.globalCompositeOperation = "destination-over";
          ctx.clearRect(0, 0, 300, 300);

          ctx.fillStyle = "rgba(0,0,0,0.4)";
          ctx.strokeStyle = "rgba(0,153,255,0.4)";
          ctx.save();
          ctx.translate(150, 150);

          const time = new Date();

          // 地球 动画帧
          ctx.rotate(
            ((2 * Math.PI) / 60) * time.getSeconds() +
              ((2 * Math.PI) / 60000) * time.getMilliseconds()
          );
          ctx.translate(105, 0);
          ctx.fillRect(0, -12, 24, 24);
          ctx.drawImage(earth, -12, -12);

          // 月亮 动画帧
          ctx.save();
          ctx.rotate(
            ((2 * Math.PI) / 6) * time.getSeconds() +
              ((2 * Math.PI) / 6000) * time.getMilliseconds()
          );
          ctx.translate(0, 28.5);
          ctx.drawImage(moon, -3.5, -3.5);
          ctx.restore();

          // 还原
          ctx.restore();

          // 绘制地球轨道
          ctx.beginPath();
          ctx.arc(150, 150, 105, 0, Math.PI * 2);
          ctx.stroke();

          // 绘制太阳
          ctx.drawImage(sun, 0, 0, 300, 300);

          // 重复动画
          window.requestAnimationFrame(draw);
        }
      }
      drawExampleOne();

      // 绘制一个时钟动画
      function drawExampleTwo() {
        init();

        function init() {
          window.requestAnimationFrame(draw);
        }

        function draw() {
          const ctx = document.getElementById("c2").getContext("2d");
          const now = new Date();

          ctx.save();
          ctx.clearRect(0, 0, 150, 150);
          ctx.translate(75, 75);
          ctx.scale(0.4, 0.4);
          ctx.rotate(-Math.PI / 2);
          ctx.strokeStyle = "black";
          ctx.fillStyle = "white";
          ctx.lineWidth = 8;
          ctx.lineCap = "round";

          // 时针
          ctx.save();
          for (let i = 0; i < 12; i++) {
            ctx.beginPath();
            ctx.rotate(Math.PI / 6);
            ctx.moveTo(100, 0);
            ctx.lineTo(120, 0);
            ctx.stroke();
          }
          ctx.restore();

          window.requestAnimationFrame(draw);
        }
      }
      drawExampleTwo();
    </script>
  </body>
</html>
